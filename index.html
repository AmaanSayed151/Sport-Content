<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload</title>
</head>
<body>

    <h2>Upload Your File</h2>
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Upload</button>

    <br><br>
    <progress id="progressBar" value="0" max="100" style="width: 100%;"></progress>
    <p id="status"></p>

    <script>
        function uploadFile() {
            var fileInput = document.getElementById('fileInput');
            var progressBar = document.getElementById('progressBar');
            var statusText = document.getElementById('status');

            if (fileInput.files.length === 0) {
                alert("Please select a file to upload.");
                return;
            }

            var file = fileInput.files[0];
            var formData = new FormData();
            formData.append("file", file);

            var xhr = new XMLHttpRequest();
            xhr.open("POST", "https://script.google.com/macros/s/AKfycbxL31_dtVJqz66Q6xWt2x0o4HazizokRmR94EAngxKyrXyV489IO1GKg7IBxUxWVRkj/exec", true);

            // âœ… Progress Bar Update
            xhr.upload.onprogress = function(event) {
                if (event.lengthComputable) {
                    var percent = (event.loaded / event.total) * 100;
                    progressBar.value = percent;
                }
            };

            xhr.onload = function() {
                if (xhr.status == 200) {
                    statusText.innerText = "File uploaded successfully!";
                    progressBar.value = 100;
                } else {
                    statusText.innerText = "Upload failed. Try again.";
                    progressBar.value = 0;
                }
            };

            xhr.onerror = function() {
                statusText.innerText = "Error occurred while uploading.";
                progressBar.value = 0;
            };

            xhr.send(formData);
        }
    </script>

</body>
</html>
